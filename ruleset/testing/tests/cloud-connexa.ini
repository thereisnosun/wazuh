[Sent a custom message with a new eventName]
log 1 pass = {"CloudConnexaLogVersion": 1, "timestamp": "2013-02-29T08:00:01+01:00", "cloudId": "my-cloud-connexa", "traceId": "012345678901234567890", "category": "Activity.Admin", "eventName": "test healthcheck", "publicIp": "19.9.9.9", "initiator": "abcde"}
rule = 93000
alert = 2
decoder = json

[Sent a Test Message - healthcheck message]
log 1 pass = {"CloudConnexaLogVersion": 1, "timestamp": "2013-02-29T08:00:01+01:00", "cloudId": "my-cloud-connexa", "traceId": "012345678901234567890", "category": "Activity.Admin", "eventName": "test-message", "publicIp": "19.9.9.9", "initiator": "abcde", "source": "CloudConnexa", "aws": {"log_info": {"aws_account_alias": "", "log_file": "2023-03-01/2023-03-01-08-01-healthcheck-abcf.json.gz", "s3bucket": "log-streaming-2-wazuh"}, "source": "CloudConnexa"}}
rule = 93001
alert = 3
decoder = json

[Send Cyber Shield Traffic Blocked]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "e50e4fd0-ea72-4406-bd7c-5f1832c3c3a0","parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "null","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "traffic-blocked","category": "Security.CyberShieldBlockedTraffic","log": {"destinationIp": "104.18.21.80","destinationPort": "80","protocol": "TCP","sourcePort": "53584","sourceIp": "100.96.1.114","signatureId": "1:99999912:1","eventName": "ET COINMINER OpenVPN generate automation event for category Cryptojacking 3","classification": "Attempted Information Leak","priority": "3","category": "Cryptojacking"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiffgab-2023-08-04-10-19-J3DU.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93002
alert = 8
decoder = json

[Send Cyber Shield Domain Blocked]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "e50b94a8-561b-449b-9099-8c4e8a4581e3","timestamp": "2023-07-24T14:57:45.000000Z","parentEntity": "new","initiator": "5d34eabe-f88d-4570-9954-818c03b90b4b","publicIp": "null","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "domain-blocked","category": "Security.CyberShieldBlockedDomains","log": {"protocol": "UDP","domain": "www.facebook.com","category": "timestealer-socialntw","queryType": "A"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idajhijdba-2023-07-24-14-58-dxKH.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93003
alert = 8
decoder = json

[Send Log Stream started]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "a7105e2c-cbda-4f60-9692-3500c9d12a61","timestamp": "2023-08-28T14:27:03.149652Z","initiatorType": "Admin","parentEntity": "e7856d84-d6b6-4803-94e1-b14e1abe483c","initiator": "2cc6965a-267e-40b2-9b67-ef2a9ecc2fe6","publicIp": "100.96.3.11","parentEntityType": "UserGroup","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "log-stream-started","category": "Audit.Admin","log": {"aws-s3-bucket": "s3-bucket","aws-region": "eu-central-1"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaghghbhg-2023-08-28-14-27-yw7e.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93020
alert = 2
decoder = json

[Send Log Stream paused]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "a7105e2c-cbda-4f60-9692-3500c9d12a61","timestamp": "2023-08-28T14:27:03.149652Z","initiatorType": "Admin","parentEntity": "e7856d84-d6b6-4803-94e1-b14e1abe483c","initiator": "2cc6965a-267e-40b2-9b67-ef2a9ecc2fe6","publicIp": "100.96.3.11","parentEntityType": "UserGroup","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "log-stream-paused","category": "Audit.Admin","log": {"aws-s3-bucket": "s3-bucket","aws-region": "eu-central-1"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaghghbhg-2023-08-28-14-27-yw7e.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93021
alert = 2
decoder = json

[Send Client connected]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "9981df9a-221a-43e6-9d80-8d0186baff25","log": {"clientUUID": "5275cf2f673acfa35906c90765ca51f6ee3ea4db25924fe699d396ad1d463ce3","protocol": "UDP","osVersion": "Ubuntu 20.04.4 LTS","tunnelIpV6": "::","tunnelIpV4": "0.0.0.0","osType": "Linux","sessionStartTime": "2023-08-01T12:04:18.000000Z","publicIp": "2600:1f1c:480:75cb:2d38:1e3b:4d56:c44c","region": "San Jose (CA)"},"parentEntity": "new","initiator": "4484f48a-9211-4f57-b042-f4d2b19a1c2b","publicIp": "2600:1f1c:480:75cb:2d38:1e3b:4d56:c44c","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-connected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idajbaifch-2023-08-01-12-04-odBZ.jsonl.gz"},"source": "CloudConnexa"},"timestamp": "2023-08-01T12:04:18.000000Z"}
rule = 93030
alert = 8
decoder = json

[Send Client disconnected]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "c01477f9-ccd9-4c7e-84aa-81f392099927","log": {"sessionDurationSeconds": "141","tunnelIpV6": "fd:0:0:8107::2","sessionEndTime": "2023-08-04T12:07:51.000000Z","tunnelIpV4": "100.96.1.114","sessionStartTime": "2023-08-04T12:05:30.000000Z","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","clientUUID": "47483912e4fcd84da9d8e11e9152990309745c8f0d407b9ac95ac5d45be823c0","disconnectReason": "User Disconnected","protocol": "UDP","osVersion": "Ubuntu 22.04.2 LTS","osType": "Linux","region": "San Jose (CA)","bytesIn": "24062","bytesOut": "18397"},"parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-disconnected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiejagj-2023-08-04-12-08-nmAD.jsonl.gz"}, "source": "CloudConnexa"}}
rule = 93031
alert = 8
decoder = json

[Send Client received more than]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "c01477f9-ccd9-4c7e-84aa-81f392099927","log": {"sessionDurationSeconds": "141","tunnelIpV6": "fd:0:0:8107::2","sessionEndTime": "2023-08-04T12:07:51.000000Z","tunnelIpV4": "100.96.1.114","sessionStartTime": "2023-08-04T12:05:30.000000Z","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","clientUUID": "47483912e4fcd84da9d8e11e9152990309745c8f0d407b9ac95ac5d45be823c0","disconnectReason": "User Disconnected","protocol": "UDP","osVersion": "Ubuntu 22.04.2 LTS","osType": "Linux","region": "San Jose (CA)","bytesIn": "524288001","bytesOut": "4444"},"parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-disconnected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiejagj-2023-08-04-12-08-nmAD.jsonl.gz"}, "source": "CloudConnexa"}}
rule = 93050
alert = 3
decoder = json

[Send Client sent more than]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "c01477f9-ccd9-4c7e-84aa-81f392099927","log": {"sessionDurationSeconds": "141","tunnelIpV6": "fd:0:0:8107::2","sessionEndTime": "2023-08-04T12:07:51.000000Z","tunnelIpV4": "100.96.1.114","sessionStartTime": "2023-08-04T12:05:30.000000Z","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","clientUUID": "47483912e4fcd84da9d8e11e9152990309745c8f0d407b9ac95ac5d45be823c0","disconnectReason": "User Disconnected","protocol": "UDP","osVersion": "Ubuntu 22.04.2 LTS","osType": "Linux","region": "San Jose (CA)","bytesIn": "524","bytesOut": "524288001"},"parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-disconnected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiejagj-2023-08-04-12-08-nmAD.jsonl.gz"}, "source": "CloudConnexa"}}
rule = 93051
alert = 3
decoder = json
