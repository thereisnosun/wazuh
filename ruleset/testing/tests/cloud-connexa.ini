[Sent a custom message with a new eventName]
log 1 pass = {"CloudConnexaLogVersion": 1, "timestamp": "2013-02-29T08:00:01+01:00", "cloudId": "my-cloud-connexa", "traceId": "012345678901234567890", "category": "Activity.Admin", "eventName": "test healthcheck", "publicIp": "19.9.9.9", "initiator": "abcde"}
rule = 93000
alert = 2
decoder = json

[Sent a Test Message - healthcheck message]
log 1 pass = {"CloudConnexaLogVersion": 1, "timestamp": "2013-02-29T08:00:01+01:00", "cloudId": "my-cloud-connexa", "traceId": "012345678901234567890", "category": "Activity.Admin", "eventName": "test-message", "publicIp": "19.9.9.9", "initiator": "abcde", "source": "CloudConnexa", "aws": {"log_info": {"aws_account_alias": "", "log_file": "2023-03-01/2023-03-01-08-01-healthcheck-abcf.json.gz", "s3bucket": "log-streaming-2-wazuh"}, "source": "CloudConnexa"}}
rule = 93001
alert = 3
decoder = json

[Send Cyber Shield Traffic Blocked]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "e50e4fd0-ea72-4406-bd7c-5f1832c3c3a0","parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "null","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "traffic-blocked","category": "Security.CyberShieldBlockedTraffic","log": {"destinationIp": "104.18.21.80","destinationPort": "80","protocol": "TCP","sourcePort": "53584","sourceIp": "100.96.1.114","signatureId": "1:99999912:1","eventName": "ET COINMINER OpenVPN generate automation event for category Cryptojacking 3","classification": "Attempted Information Leak","priority": "3","category": "Cryptojacking"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiffgab-2023-08-04-10-19-J3DU.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93002
alert = 8
decoder = json

[Send Cyber Shield Domain Blocked]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "e50b94a8-561b-449b-9099-8c4e8a4581e3","timestamp": "2023-07-24T14:57:45.000000Z","parentEntity": "new","initiator": "5d34eabe-f88d-4570-9954-818c03b90b4b","publicIp": "null","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "domain-blocked","category": "Security.CyberShieldBlockedDomains","log": {"protocol": "UDP","domain": "www.facebook.com","category": "timestealer-socialntw","queryType": "A"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idajhijdba-2023-07-24-14-58-dxKH.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93003
alert = 8
decoder = json

[Send Log Stream started]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "a7105e2c-cbda-4f60-9692-3500c9d12a61","timestamp": "2023-08-28T14:27:03.149652Z","initiatorType": "Admin","parentEntity": "e7856d84-d6b6-4803-94e1-b14e1abe483c","initiator": "2cc6965a-267e-40b2-9b67-ef2a9ecc2fe6","publicIp": "100.96.3.11","parentEntityType": "UserGroup","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "log-stream-started","category": "Audit.Admin","log": {"aws-s3-bucket": "s3-bucket","aws-region": "eu-central-1"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaghghbhg-2023-08-28-14-27-yw7e.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93020
alert = 2
decoder = json

[Send Log Stream paused]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "a7105e2c-cbda-4f60-9692-3500c9d12a61","timestamp": "2023-08-28T14:27:03.149652Z","initiatorType": "Admin","parentEntity": "e7856d84-d6b6-4803-94e1-b14e1abe483c","initiator": "2cc6965a-267e-40b2-9b67-ef2a9ecc2fe6","publicIp": "100.96.3.11","parentEntityType": "UserGroup","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "log-stream-paused","category": "Audit.Admin","log": {"aws-s3-bucket": "s3-bucket","aws-region": "eu-central-1"},"aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaghghbhg-2023-08-28-14-27-yw7e.jsonl.gz"},"source": "CloudConnexa"}}
rule = 93021
alert = 2
decoder = json

[Send Client connected]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "9981df9a-221a-43e6-9d80-8d0186baff25","log": {"clientUUID": "5275cf2f673acfa35906c90765ca51f6ee3ea4db25924fe699d396ad1d463ce3","protocol": "UDP","osVersion": "Ubuntu 20.04.4 LTS","tunnelIpV6": "::","tunnelIpV4": "0.0.0.0","osType": "Linux","sessionStartTime": "2023-08-01T12:04:18.000000Z","publicIp": "2600:1f1c:480:75cb:2d38:1e3b:4d56:c44c","region": "San Jose (CA)"},"parentEntity": "new","initiator": "4484f48a-9211-4f57-b042-f4d2b19a1c2b","publicIp": "2600:1f1c:480:75cb:2d38:1e3b:4d56:c44c","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-connected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idajbaifch-2023-08-01-12-04-odBZ.jsonl.gz"},"source": "CloudConnexa"},"timestamp": "2023-08-01T12:04:18.000000Z"}
rule = 93030
alert = 8
decoder = json

[Send Client disconnected]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "c01477f9-ccd9-4c7e-84aa-81f392099927","log": {"sessionBytesIn": "24062","sessionBytesOut": "18397"},"parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-disconnected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiejagj-2023-08-04-12-08-nmAD.jsonl.gz"}, "source": "CloudConnexa"}}
rule = 93031
alert = 8
decoder = json

[Send Client received more than]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "c01477f9-ccd9-4c7e-84aa-81f392099927","log": {"sessionBytesIn": "524288001","sessionBytesOut": "4444"},"parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-disconnected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiejagj-2023-08-04-12-08-nmAD.jsonl.gz"}, "source": "CloudConnexa"}}
rule = 93050
alert = 3
decoder = json

[Send Client sent more than]
log 1 pass = {"CloudConnexaLogVersion": 1, "traceId": "c01477f9-ccd9-4c7e-84aa-81f392099927","log": {"sessionBytesIn": "524","sessionBytesOut": "524288001"},"parentEntity": "user2","initiator": "0ad3e479-d1d4-4cc3-a466-d7020cdf518c","publicIp": "2600:1f1c:480:75cb:456f:a183:7166:30d9","source": "CloudConnexa","service": "CloudConnexa","cloudId": "my-cloud-connexa","eventName": "client-disconnected","category": "Security.Logins","aws": {"log_info": {"s3bucket": "s3-bucket","log_file": "CloudConnexa/my-cloud-connexa/idaiiejagj-2023-08-04-12-08-nmAD.jsonl.gz"}, "source": "CloudConnexa"}}
rule = 93051
alert = 3
decoder = json

[Send Audit Log event]
log 1 pass = {"CloudConnexaLogVersion": 1,"timestamp": "2024-07-18T08:44:45.917000Z","cloudId": "test","service": "CloudConnexa","traceId": "6f4e4a02-c851-423c-a774-f22a303f9e44","parentEntity": "user1143@test","parentEntityType": "UserGroup","eventName": "audit-log","log": {"operation": "Created","entityType": "User","entityId": "user1143@test","entityName": null,"entityParentType": "UserGroup","entityParentId": "user1143@test","fields": [{"name": "Username","oldValue": null,"newValue": "user1143"}]}}
rule = 93040
alert = 2
decoder = json

[Send Access Visibility]
log 1 pass = {"CloudConnexaLogVersion": 1,"timestamp": "2024-07-17T19:57:43.000000Z","cloudId": "test","service": "CloudConnexa","traceId": "3b98f2c9-8eba-4e9d-adc4-e0a8a502bee1","publicIp": "2607:fea8:fda0:7da4:9108:7c52:651a:27e1","initiator": "user@openvpn.net","initiatorType": "User","parentEntity": "778f8fa2-d7c9-4c76-94c9-8b24d157f0ad","parentEntityType": "Group","category": "Activity.AV","eventName": "flow-established","log": {"clientSessionId": "66981f054c5be0e60dee836b","sourceParentId": "user@openvpn.net","sourceParentType": "User","sourceEntityId": "2ab8a2f2-60ca-4db7-b73d-8607d51e1735","sourceEntityType": "Device","sourceIp": "100.96.1.18","sourceGatewayRegion": "us-central-1","destinationParentId": "778f8fa2-d7c9-4c76-94c9-8b24d157f0ad","destinationParentType": "Group","destinationEntityId": null,"destinationEntityType": "Device","destinationEntityIp": "100.96.1.20","destinationPort": 80,"destinationGatewayRegion": null,"allowed": false,"protocolName": "tcp","protocol": "6","sourceGatewayRegionName": "Chicago (IL)","destinationGatewayRegionName": null,"sourceParentName": "Owner","sourceEntityName": "MacBook-3","destinationEntityName": null,"destinationParentName": "Owner"}}
rule = 93041
alert = 3
decoder = json
